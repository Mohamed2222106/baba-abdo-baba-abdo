<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة المطعم</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f8f9fa; text-align: center; }
        h1 { color: #333; }
        .container { width: 80%; margin: auto; }
        .section { background: white; padding: 15px; margin: 10px 0; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        .menu-section h2, .table-section h2 { color: #007bff; }
        .menu-item, .order-item, .table-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #ddd; }
        button { margin: 5px; padding: 10px; border: none; cursor: pointer; border-radius: 5px; }
        .add-btn { background: #007bff; color: white; }
        .delete { background: red; color: white; }
        .note-btn { background: orange; color: white; }
    </style>
</head>
<body>
    <h1>إدارة المطعم</h1>
    <div class="container">

        <!-- إدارة الطاولات -->
        <div class="section table-section">
            <h2>🪑 إدارة الطاولات</h2>
            <button class="add-btn" onclick="addTable()">+ إضافة طاولة جديدة</button>
            <div id="tables"></div>
        </div>

        <!-- إدارة المنيو -->
        <div class="section menu-section">
            <h2>🍽️ إدارة المنيو</h2>
            <button class="add-btn" onclick="addSection()">+ إضافة قسم جديد</button>
            <div id="menu"></div>
        </div>
    </div>

    <script>
        let menu = JSON.parse(localStorage.getItem("menu")) || {};
        let tables = JSON.parse(localStorage.getItem("tables")) || {};

        function saveData() {
            localStorage.setItem("menu", JSON.stringify(menu));
            localStorage.setItem("tables", JSON.stringify(tables));
        }

        /* إدارة الطاولات */
        function renderTables() {
            let tablesDiv = document.getElementById("tables");
            tablesDiv.innerHTML = "";
            Object.keys(tables).forEach(tableId => {
                let tableDiv = document.createElement("div");
                tableDiv.className = "table-item";
                tableDiv.innerHTML = `
                    <strong>طاولة ${tableId}</strong>
                    <button onclick="viewOrders('${tableId}')">📜 عرض الطلبات</button>
                    <button class="delete" onclick="deleteTable('${tableId}')">❌ حذف</button>
                `;
                tablesDiv.appendChild(tableDiv);
            });
        }

        function addTable() {
            let tableId = prompt("أدخل رقم الطاولة:");
            if (tableId && !tables[tableId]) {
                tables[tableId] = [];
                saveData();
                renderTables();
            }
        }

        function deleteTable(tableId) {
            if (confirm(`هل تريد حذف الطاولة ${tableId}؟`)) {
                delete tables[tableId];
                saveData();
                renderTables();
            }
        }

        function viewOrders(tableId) {
            let orders = tables[tableId] || [];
            let orderList = orders.map((o, i) => `
                <div class="order-item">
                    ${o.name} ${o.type ? `(${o.type})` : ""} ${o.note ? `- ملاحظة: ${o.note}` : ""}
                    <button onclick="setOrderType('${tableId}', ${i}, 'اسباجتي')">اسباجتي</button>
                    <button onclick="setOrderType('${tableId}', ${i}, 'مقصوصة')">مقصوصة</button>
                    <button class="note-btn" onclick="addNote('${tableId}', ${i})">ملحوظة</button>
                    <button class="delete" onclick="removeOrder('${tableId}', ${i})">❌</button>
                </div>
            `).join("");

            let orderWindow = window.open("", "", "width=500,height=600");
            orderWindow.document.write(`<h2>طلبات الطاولة ${tableId}</h2>${orderList}`);
        }

        function addNote(tableId, index) {
            let note = prompt("أدخل الملاحظة:");
            if (note) {
                tables[tableId][index].note = note;
                saveData();
                viewOrders(tableId);
            }
        }

        function setOrderType(tableId, index, type) {
            tables[tableId][index].type = type;
            saveData();
            viewOrders(tableId);
        }

        function removeOrder(tableId, index) {
            tables[tableId].splice(index, 1);
            saveData();
            viewOrders(tableId);
        }

        /* إدارة المنيو */
        function renderMenu() {
            let menuDiv = document.getElementById("menu");
            menuDiv.innerHTML = "";
            Object.keys(menu).forEach(section => {
                let sectionDiv = document.createElement("div");
                sectionDiv.className = "menu-section";
                sectionDiv.innerHTML = `
                    <h2>${section} 
                        <button class="delete" onclick="deleteSection('${section}')">❌ حذف</button>
                    </h2>
                    <button class="add-btn" onclick="addItem('${section}')">+ إضافة صنف</button>
                    <div id="items-${section}"></div>
                `;
                menuDiv.appendChild(sectionDiv);
                renderItems(section);
            });
        }

        function renderItems(section) {
            let itemsDiv = document.getElementById(`items-${section}`);
            itemsDiv.innerHTML = "";
            menu[section].forEach(item => {
                let itemDiv = document.createElement("div");
                itemDiv.className = "menu-item";
                itemDiv.innerHTML = `
                    ${item} 
                    <button onclick="selectTableForOrder('${item}')">➕ أضف للطاولة</button>
                `;
                itemsDiv.appendChild(itemDiv);
            });
        }

        function selectTableForOrder(itemName) {
            let tableId = prompt("أدخل رقم الطاولة:");
            if (tableId && tables[tableId]) {
                tables[tableId].push({ name: itemName, type: "", note: "" });
                saveData();
                alert(`تمت إضافة ${itemName} إلى الطاولة ${tableId}`);
            } else {
                alert("الطاولة غير موجودة!");
            }
        }

        function addSection() {
            let sectionName = prompt("أدخل اسم القسم الجديد:");
            if (sectionName && !menu[sectionName]) {
                menu[sectionName] = [];
                saveData();
                renderMenu();
            }
        }

        function deleteSection(section) {
            if (confirm(`هل تريد حذف قسم "${section}"؟`)) {
                delete menu[section];
                saveData();
                renderMenu();
            }
        }

        function addItem(section) {
            let itemName = prompt(`أدخل اسم الصنف الجديد في قسم "${section}":`);
            if (itemName) {
                menu[section].push(itemName);
                saveData();
                renderItems(section);
            }
        }

        renderTables();
        renderMenu();
    </script>
</body>
</html>
