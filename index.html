<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; direction: rtl; background-color: #f8f8f8; }
        header { background: #ff6600; color: white; padding: 15px; font-size: 24px; }
        button { padding: 10px 20px; margin: 5px; background: red; color: white; border: none; cursor: pointer; border-radius: 5px; }
        .table { width: 100px; height: 100px; background: white; border: 2px solid #ff6600; margin: 10px; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 8px; }
        .order-item { background: white; padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>
    <header>
        <h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§ÙˆÙ„Ø§Øª</h1>
    </header>

    <main>
        <button onclick="createTables()">Ø¥Ù†Ø´Ø§Ø¡ Ø·Ø§ÙˆÙ„Ø§Øª</button>
        <button onclick="openMenuPopup()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ÙŠÙˆ</button>
        <button onclick="showAllOrders()">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</button>
        <div id="tablesContainer"></div>
    </main>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ÙŠÙˆ -->
    <div id="menuPopup" style="display: none;">
        <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ÙŠÙˆ</h2>
        <button onclick="addMenuSection()">Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯</button>
        <div id="menuSections"></div>
        <button onclick="closeMenuPopup()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ØµÙ†Ø§Ù -->
    <div id="menuSelectionPopup" style="display: none;">
        <h2>Ø§Ø®ØªØ± ØµÙ†ÙÙ‹Ø§</h2>
        <div id="menuItems"></div>
        <button onclick="closeMenuSelection()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <!-- ØµÙØ­Ø© Ø§Ù„Ø·Ø§ÙˆÙ„Ø© -->
    <div id="tablePage" style="display: none;">
        <h2 id="tableTitle"></h2>
        <div id="orderList"></div>
        <h3>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="totalPrice">0</span> Ø¬Ù†ÙŠÙ‡</h3>
        <button onclick="closeTablePage()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <script>
        function createTables() {
            let num = prompt("ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø§ÙˆÙ„Ø§ØªØŸ");
            if (!num || isNaN(num) || num <= 0) return;
            localStorage.setItem("numTables", num);
            loadTables();
        }

        function loadTables() {
            let num = localStorage.getItem("numTables") || 0;
            let container = document.getElementById("tablesContainer");
            container.innerHTML = "";
            for (let i = 1; i <= num; i++) {
                let table = document.createElement("div");
                table.classList.add("table");
                table.textContent = `Ø·Ø§ÙˆÙ„Ø© ${i}`;
                table.setAttribute("data-table", i);
                table.addEventListener("click", () => openTable(i));
                container.appendChild(table);
            }
        }

        function openTable(tableNumber) {
            document.getElementById("tablePage").style.display = "block";
            document.getElementById("tableTitle").textContent = `Ø·Ø§ÙˆÙ„Ø© ${tableNumber}`;
            document.getElementById("orderList").innerHTML = "";
            let orders = JSON.parse(localStorage.getItem(`table_${tableNumber}`)) || [];
            updateTableOrders(tableNumber, orders);
        }

        function closeTablePage() {
            document.getElementById("tablePage").style.display = "none";
        }

        function openMenuSelection(tableNumber) {
            document.getElementById("menuSelectionPopup").style.display = "block";
            let menuItems = JSON.parse(localStorage.getItem("menuSections")) || [];
            let container = document.getElementById("menuItems");
            container.innerHTML = "";
            menuItems.forEach((section) => {
                let div = document.createElement("div");
                div.innerHTML = `<strong>${section.name}</strong>`;
                section.items.forEach((item) => {
                    let button = document.createElement("button");
                    button.textContent = `${item.name} - ${item.price} Ø¬Ù†ÙŠÙ‡`;
                    button.onclick = () => addOrder(tableNumber, item.name, item.price);
                    div.appendChild(button);
                });
                container.appendChild(div);
            });
        }

        function closeMenuSelection() {
            document.getElementById("menuSelectionPopup").style.display = "none";
        }

        function addOrder(tableNumber, itemName, price) {
            let orders = JSON.parse(localStorage.getItem(`table_${tableNumber}`)) || [];
            orders.push({ name: itemName, price: parseFloat(price), note: "", extra: null });
            localStorage.setItem(`table_${tableNumber}`, JSON.stringify(orders));
            updateTableOrders(tableNumber, orders);
            closeMenuSelection();
        }

        function updateTableOrders(tableNumber, orders) {
            let orderList = document.getElementById("orderList");
            orderList.innerHTML = "";
            let totalPrice = 0;

            orders.forEach((order, index) => {
                totalPrice += order.price;
                let div = document.createElement("div");
                div.classList.add("order-item");
                div.innerHTML = `
                    ${order.name} ${order.extra ? `+ ${order.extra}` : ""}
                    (${order.price} Ø¬Ù†ÙŠÙ‡)
                    <button onclick="addExtra(${tableNumber}, ${index})">Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
                    <button onclick="addNote(${tableNumber}, ${index})">Ù…Ù„Ø­ÙˆØ¸Ø©</button>
                `;
                orderList.appendChild(div);
            });

            document.getElementById("totalPrice").textContent = totalPrice;
        }

        function addExtra(tableNumber, index) {
            openMenuSelection(tableNumber);
            let menuItems = JSON.parse(localStorage.getItem("menuSections")) || [];
            menuItems.forEach((section) => {
                section.items.forEach((item) => {
                    item.onclick = () => {
                        let orders = JSON.parse(localStorage.getItem(`table_${tableNumber}`)) || [];
                        orders[index].extra = item.name;
                        orders[index].price += parseFloat(item.price);
                        localStorage.setItem(`table_${tableNumber}`, JSON.stringify(orders));
                        updateTableOrders(tableNumber, orders);
                    };
                });
            });
        }

        function addNote(tableNumber, index) {
            let choice = prompt("Ø§Ø®ØªØ±: 1- Ø¥Ø³Ø¨Ø§Ø¬ØªÙŠ | 2- Ù…Ù‚ØµÙˆØµØ©");
            if (choice == "1") choice = "Ø¥Ø³Ø¨Ø§Ø¬ØªÙŠ";
            else if (choice == "2") choice = "Ù…Ù‚ØµÙˆØµØ©";
            else return;

            let orders = JSON.parse(localStorage.getItem(`table_${tableNumber}`)) || [];
            orders[index].note = choice;
            localStorage.setItem(`table_${tableNumber}`, JSON.stringify(orders));
            updateTableOrders(tableNumber, orders);
        }

        function openMenuPopup() {
            document.getElementById("menuPopup").style.display = "block";
        }

        function closeMenuPopup() {
            document.getElementById("menuPopup").style.display = "none";
        }

        function showAllOrders() {
            alert("ğŸš€ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§!");
        }

        loadTables();
    </script>
</body>
</html>
