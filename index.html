<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة المطعم</title>
    <style>
        body { font-family: Arial, sans-serif; direction: rtl; text-align: right; margin: 20px; }
        button { margin: 5px; padding: 10px; cursor: pointer; }
        #menuManagement, #selectedItemsPage { display: none; margin-top: 20px; }
    </style>
</head>
<body>

    <h1>إدارة الطاولات والمنيو</h1>
    
    <button id="manageMenuBtn">إدارة المنيو</button>
    <button id="allSelectedItemsBtn">جميع الأصناف المختارة</button>

    <h2>الطاولات</h2>
    <button id="addTable">إضافة طاولة</button>
    <div id="tables"></div>

    <!-- إدارة المنيو -->
    <div id="menuManagement">
        <h2>إدارة المنيو</h2>
        <button id="addCategory">إضافة قسم</button>
        <div id="menuCategories"></div>
    </div>

    <!-- جميع الأصناف المختارة -->
    <div id="selectedItemsPage">
        <h2>جميع الأصناف المختارة</h2>
        <ul id="selectedItemsList"></ul>
        <button id="clearAllItems">حذف الكل</button>
        <button onclick="document.getElementById('selectedItemsPage').style.display='none'">إغلاق</button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            loadTables();
            loadMenu();

            document.getElementById("manageMenuBtn").addEventListener("click", function() {
                document.getElementById("menuManagement").style.display = "block";
            });

            document.getElementById("addTable").addEventListener("click", function() {
                let tableName = prompt("أدخل اسم الطاولة:");
                if (tableName) {
                    let tables = JSON.parse(localStorage.getItem("tables")) || [];
                    tables.push({ name: tableName, items: [] });
                    localStorage.setItem("tables", JSON.stringify(tables));
                    loadTables();
                }
            });

            document.getElementById("addCategory").addEventListener("click", function() {
                let categoryName = prompt("أدخل اسم القسم:");
                if (categoryName) {
                    let menu = JSON.parse(localStorage.getItem("menu")) || {};
                    menu[categoryName] = [];
                    localStorage.setItem("menu", JSON.stringify(menu));
                    loadMenu();
                }
            });

            document.getElementById("allSelectedItemsBtn").addEventListener("click", function() {
                document.getElementById("selectedItemsPage").style.display = "block";
                loadSelectedItems();
            });

            document.getElementById("clearAllItems").addEventListener("click", function() {
                localStorage.removeItem("selectedItems");
                document.getElementById("selectedItemsList").innerHTML = "";
            });
        });

        function loadTables() {
            let tables = JSON.parse(localStorage.getItem("tables")) || [];
            let tablesDiv = document.getElementById("tables");
            tablesDiv.innerHTML = "";
            tables.forEach((table, index) => {
                let div = document.createElement("div");
                div.innerHTML = `<h3>${table.name}</h3>
                    <button onclick="addItemToTable(${index})">إضافة صنف</button>
                    <ul id="table-${index}">${table.items.map(item => `<li>${item} <button onclick="removeItemFromTable(${index}, '${item}')">حذف</button></li>`).join('')}</ul>`;
                tablesDiv.appendChild(div);
            });
        }

        function addItemToTable(tableIndex) {
            let menu = JSON.parse(localStorage.getItem("menu")) || {};
            let allItems = Object.values(menu).flat();
            if (allItems.length === 0) {
                alert("المنيو فارغ، أضف أصناف أولاً!");
                return;
            }

            let item = prompt(`اختر صنف:\n${allItems.join("\n")}`);
            if (item && allItems.includes(item)) {
                let tables = JSON.parse(localStorage.getItem("tables"));
                tables[tableIndex].items.push(item);
                localStorage.setItem("tables", JSON.stringify(tables));

                let selectedItems = JSON.parse(localStorage.getItem("selectedItems")) || [];
                selectedItems.push(item);
                localStorage.setItem("selectedItems", JSON.stringify(selectedItems));

                loadTables();
            } else {
                alert("صنف غير موجود!");
            }
        }

        function removeItemFromTable(tableIndex, item) {
            let tables = JSON.parse(localStorage.getItem("tables"));
            tables[tableIndex].items = tables[tableIndex].items.filter(i => i !== item);
            localStorage.setItem("tables", JSON.stringify(tables));
            loadTables();
        }

        function loadMenu() {
            let menu = JSON.parse(localStorage.getItem("menu")) || {};
            let menuDiv = document.getElementById("menuCategories");
            menuDiv.innerHTML = "";
            Object.keys(menu).forEach(category => {
                let div = document.createElement("div");
                div.innerHTML = `<h3>${category}</h3><button onclick="addItem('${category}')">إضافة صنف</button>`;
                menuDiv.appendChild(div);
            });
        }

        function addItem(category) {
            let itemName = prompt("أدخل اسم الصنف:");
            if (itemName) {
                let menu = JSON.parse(localStorage.getItem("menu"));
                menu[category].push(itemName);
                localStorage.setItem("menu", JSON.stringify(menu));
                loadMenu();
            }
        }

        function loadSelectedItems() {
            let selectedItems = JSON.parse(localStorage.getItem("selectedItems")) || [];
            let list = document.getElementById("selectedItemsList");
            list.innerHTML = "";
            selectedItems.forEach(item => {
                let li = document.createElement("li");
                li.textContent = item;
                list.appendChild(li);
            });
        }
    </script>

</body>
</html>
